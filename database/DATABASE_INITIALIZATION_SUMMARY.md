# MIRIX æ•°æ®åº“åˆå§‹åŒ–æ›´æ–°æ€»ç»“

## ğŸ“Š æ›´æ–°æ—¥æœŸ
2025-10-21

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. å¯¼å‡ºç°æœ‰æ•°æ®åº“ç»“æ„
- âœ… ä»è¿è¡Œä¸­çš„ PostgreSQL æ•°æ®åº“å¯¼å‡ºå®Œæ•´ schema
- âœ… è¯†åˆ«æ‰€æœ‰ 22 ä¸ªè¡¨åŠå…¶å…³ç³»
- âœ… ä¿ç•™æ‰€æœ‰æ‰©å±•ã€ç±»å‹å’Œç´¢å¼•å®šä¹‰

### 2. åˆ›å»ºå®Œæ•´çš„åˆå§‹åŒ–è„šæœ¬

#### database/init_complete.sql
**å®Œæ•´çš„ SQL åˆå§‹åŒ–è„šæœ¬**ï¼ŒåŒ…å«:
- âœ… æ•°æ®åº“æ‰©å±•ï¼ˆuuid-ossp, vectorï¼‰
- âœ… è‡ªå®šä¹‰ç±»å‹ï¼ˆsandboxtypeï¼‰
- âœ… æ‰€æœ‰ 22 ä¸ªè¡¨çš„å®Œæ•´å®šä¹‰
- âœ… è¡¨æ³¨é‡Šå’Œæ–‡æ¡£
- âœ… æ€§èƒ½ç´¢å¼•
- âœ… é»˜è®¤ç”¨æˆ·å’Œç»„ç»‡æ•°æ®

**è¡¨ç»“æ„**ï¼ˆ22 ä¸ªè¡¨ï¼‰:
1. users - ç”¨æˆ·ä¿¡æ¯
2. user_settings - ç”¨æˆ·è®¾ç½®
3. organizations - ç»„ç»‡ç®¡ç†
4. agents - Agent é…ç½®
5. agents_tags - Agent æ ‡ç­¾
6. agent_environment_variables - Agent ç¯å¢ƒå˜é‡
7. messages - æ¶ˆæ¯è®°å½•
8. steps - å·¥ä½œæµæ­¥éª¤
9. episodic_memory - æƒ…æ™¯è®°å¿†
10. semantic_memory - è¯­ä¹‰è®°å¿†
11. procedural_memory - ç¨‹åºè®°å¿†
12. resource_memory - èµ„æºè®°å¿†
13. knowledge_vault - çŸ¥è¯†åº“
14. files - æ–‡ä»¶ç®¡ç†
15. cloud_file_mapping - äº‘æ–‡ä»¶æ˜ å°„
16. tools - å·¥å…·å®šä¹‰
17. tools_agents - å·¥å…·-Agent å…³è”
18. providers - æä¾›å•†é…ç½®
19. sandbox_configs - æ²™ç®±é…ç½®
20. sandbox_environment_variables - æ²™ç®±ç¯å¢ƒå˜é‡
21. block - Block é…ç½®
22. blocks_agents - Block-Agent å…³è”

#### database/init_db.py
**Python åˆå§‹åŒ–å·¥å…·**ï¼Œæä¾›:
- âœ… äº¤äº’å¼åˆå§‹åŒ–æµç¨‹
- âœ… è‡ªåŠ¨éªŒè¯æ‰©å±•å’Œè¡¨
- âœ… ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… å¼ºåˆ¶é‡ç½®é€‰é¡¹

### 3. æ›´æ–° Docker Compose é…ç½®

#### docker-compose.yml
- âœ… æ›´æ–° PostgreSQL åˆå§‹åŒ–è„šæœ¬è·¯å¾„
- âœ… ä½¿ç”¨ `init_complete.sql` æ›¿ä»£æ—§çš„ `init.sql`

#### docker-compose.registry.yml
- âœ… æ·»åŠ æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬æŒ‚è½½
- âœ… ç¡®ä¿ç§æœ‰ä»“åº“éƒ¨ç½²ä¹Ÿèƒ½æ­£ç¡®åˆå§‹åŒ–

### 4. åˆ›å»ºæ–‡æ¡£

#### database/README.md
**å®Œæ•´çš„æ•°æ®åº“æ–‡æ¡£**ï¼ŒåŒ…å«:
- âœ… æ•°æ®åº“æ¶æ„è¯´æ˜
- âœ… 3 ç§åˆå§‹åŒ–æ–¹æ³•
- âœ… å¤‡ä»½å’Œæ¢å¤æŒ‡å—
- âœ… æ€§èƒ½ä¼˜åŒ–å»ºè®®
- âœ… æ•…éšœæ’é™¤æŒ‡å—

#### database/schema_dump.sql
- âœ… å®Œæ•´çš„ schema å¯¼å‡ºï¼ˆ1079 è¡Œï¼‰
- âœ… åŒ…å«æ‰€æœ‰è¡¨å®šä¹‰å’Œç´¢å¼•
- âœ… ä½œä¸ºå‚è€ƒå’Œå¯¹æ¯”ç”¨é€”

## ğŸ“‚ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶
1. `database/init_complete.sql` - å®Œæ•´åˆå§‹åŒ–è„šæœ¬
2. `database/init_db.py` - Python åˆå§‹åŒ–å·¥å…·
3. `database/README.md` - æ•°æ®åº“æ–‡æ¡£
4. `database/schema_dump.sql` - Schema å¯¼å‡º
5. `database/DATABASE_INITIALIZATION_SUMMARY.md` - æœ¬æ–‡æ¡£

### ä¿®æ”¹æ–‡ä»¶
1. `docker-compose.yml` - æ›´æ–°åˆå§‹åŒ–è„šæœ¬è·¯å¾„
2. `docker-compose.registry.yml` - æ·»åŠ åˆå§‹åŒ–è„šæœ¬æŒ‚è½½

## ğŸ¯ å…³é”®ç‰¹æ€§

### 1. å®Œæ•´æ€§
- âœ… åŒ…å«æ‰€æœ‰ç°æœ‰è¡¨ç»“æ„
- âœ… ä¿ç•™æ‰€æœ‰ç´¢å¼•å’Œçº¦æŸ
- âœ… åŒ…å«å‘é‡æ‰©å±•é…ç½®

### 2. ç”¨æˆ·éš”ç¦»
æ‰€æœ‰æ•°æ®è¡¨éƒ½åŒ…å« `user_id` å­—æ®µï¼Œæ”¯æŒ:
- âœ… å¤šç”¨æˆ·æ•°æ®éš”ç¦»
- âœ… åŸºäºç”¨æˆ·çš„æŸ¥è¯¢ä¼˜åŒ–
- âœ… ç”¨æˆ·çº§åˆ«çš„æ•°æ®ç®¡ç†

### 3. å‘é‡æ”¯æŒ
Memory è¡¨ï¼ˆ5 ä¸ªï¼‰éƒ½åŒ…å«å‘é‡å­—æ®µ:
- âœ… 4096 ç»´å‘é‡ï¼ˆæ”¯æŒå¤šç§ embedding æ¨¡å‹ï¼‰
- âœ… ä¸ºæ¯ç§å†…å®¹ç±»å‹æä¾›ç‹¬ç«‹çš„ embedding å­—æ®µ
- âœ… é¢„ç•™å‘é‡ç´¢å¼•æ‰©å±•ç©ºé—´

### 4. è½¯åˆ é™¤
æ‰€æœ‰è¡¨éƒ½æ”¯æŒè½¯åˆ é™¤:
- âœ… `is_deleted` æ ‡è®°
- âœ… ç´¢å¼•æ’é™¤å·²åˆ é™¤è®°å½•
- âœ… ä¿ç•™å†å²æ•°æ®

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### Docker Compose è‡ªåŠ¨åˆå§‹åŒ–ï¼ˆæ¨èï¼‰

```bash
# é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨åˆå§‹åŒ–
docker-compose up -d

# æˆ–åªå¯åŠ¨æ•°æ®åº“
docker-compose up -d postgres
```

### Python è„šæœ¬åˆå§‹åŒ–

```bash
# è®¾ç½®æ•°æ®åº“è¿æ¥
export MIRIX_PG_URI='postgresql://mirix:mirix123@localhost:5432/mirix'

# è¿è¡Œåˆå§‹åŒ–
python database/init_db.py

# å¼ºåˆ¶é‡æ–°åˆå§‹åŒ–
python database/init_db.py --force
```

### æ‰‹åŠ¨ SQL åˆå§‹åŒ–

```bash
# ç›´æ¥æ‰§è¡Œ SQL
psql -U mirix -d mirix -f database/init_complete.sql

# æˆ–é€šè¿‡ Docker
docker-compose exec -T postgres psql -U mirix -d mirix < database/init_complete.sql
```

## ğŸ” éªŒè¯åˆå§‹åŒ–

```bash
# ä½¿ç”¨ Python å·¥å…·æŸ¥çœ‹çŠ¶æ€
python database/init_db.py

# æˆ–ç›´æ¥æŸ¥è¯¢
docker-compose exec postgres psql -U mirix -d mirix -c "\dt"
```

é¢„æœŸè¾“å‡º:
- 22 ä¸ªè¡¨
- 2 ä¸ªæ‰©å±•ï¼ˆuuid-ossp, vectorï¼‰
- é»˜è®¤ç”¨æˆ·å’Œç»„ç»‡

## ğŸ“ é»˜è®¤æ•°æ®

### é»˜è®¤ç”¨æˆ·
```
ID: user-00000000-0000-4000-8000-000000000000
åç§°: Default User
```

### é»˜è®¤ç»„ç»‡
```
ID: org-00000000-0000-4000-8000-000000000000
åç§°: Default Organization
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œ**: Docker Compose åªåœ¨é¦–æ¬¡åˆ›å»ºå®¹å™¨æ—¶æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
2. **é‡ç½®æ•°æ®**: å¦‚éœ€é‡æ–°åˆå§‹åŒ–ï¼Œéœ€åˆ é™¤æ•°æ®å·æˆ–ä½¿ç”¨ `--force` é€‰é¡¹
3. **å¤‡ä»½**: åœ¨ç”Ÿäº§ç¯å¢ƒä¿®æ”¹å‰åŠ¡å¿…å¤‡ä»½æ•°æ®
4. **å‘é‡ç´¢å¼•**: å¯¹äºå¤§é‡æ•°æ®ï¼Œå»ºè®®åˆ›å»º HNSW æˆ– IVFFlat ç´¢å¼•

## ğŸ”„ è¿ç§»ç­–ç•¥

å°†æ¥çš„ schema å˜æ›´åº”è¯¥:
1. åˆ›å»ºè¿ç§»è„šæœ¬ `database/migrations/XXX_description.sql`
2. åœ¨è¿ç§»è„šæœ¬ä¸­åŒ…å«å‘å‰å’Œå‘åè¿ç§»
3. æ›´æ–° `init_complete.sql` ä»¥åæ˜ æœ€æ–° schema
4. æ›´æ–°æ–‡æ¡£è¯´æ˜å˜æ›´

## ğŸ‰ æˆæœ

- âœ… å®Œæ•´çš„æ•°æ®åº“æ¶æ„å®šä¹‰
- âœ… è‡ªåŠ¨åŒ–åˆå§‹åŒ–æµç¨‹
- âœ… è¯¦ç»†çš„æ–‡æ¡£å’ŒæŒ‡å—
- âœ… çµæ´»çš„åˆå§‹åŒ–é€‰é¡¹
- âœ… ç”Ÿäº§å°±ç»ªçš„é…ç½®

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [database/README.md](README.md) - å®Œæ•´æ•°æ®åº“æ–‡æ¡£
- [database/init_complete.sql](init_complete.sql) - SQL åˆå§‹åŒ–è„šæœ¬
- [database/init_db.py](init_db.py) - Python åˆå§‹åŒ–å·¥å…·

---

**æ›´æ–°å®Œæˆï¼ç°åœ¨ MIRIX æ‹¥æœ‰å®Œæ•´ã€è§„èŒƒçš„æ•°æ®åº“åˆå§‹åŒ–ç³»ç»Ÿã€‚**
